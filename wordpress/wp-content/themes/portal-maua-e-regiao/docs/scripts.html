<!DOCTYPE html>

<html>
<head>
  <title>scripts.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>scripts.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>Portal = {}

Portal.apps =</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Cria paginador com o plugin <code>jPages</code> em páginas onde constará listas de
notícias do Portal, divididas por categorias.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">paginador</span>:<span class="hljs-function"> -&gt;</span>
    paginas = $ <span class="hljs-string">'.paginador'</span>

    <span class="hljs-keyword">if</span> paginas[<span class="hljs-number">0</span>]
      indice        = $ <span class="hljs-string">'.indice'</span>
      inputPagina   = $ <span class="hljs-string">'input[name="digitar-pagina"]'</span>
      maximoPaginas = <span class="hljs-number">6</span>

      paginas.jPages {
        container : <span class="hljs-string">'.chamadas, .resultados, .publicidade-destaques, .publicacoes'</span>
        perPage   : maximoPaginas
        <span class="hljs-attribute">startRange</span>: <span class="hljs-number">1</span>
        endRange  : <span class="hljs-number">1</span>
        first     : <span class="hljs-string">'.primeira'</span>
        last      : <span class="hljs-string">'.ultima'</span>
        next      : <span class="hljs-string">'.proxima'</span>
        previous  : <span class="hljs-string">'.anterior'</span>
        <span class="hljs-attribute">callback</span>: <span class="hljs-function"><span class="hljs-params">(paginas, itens)</span> -&gt;</span>
          <span class="hljs-keyword">if</span> paginas.count &gt;= <span class="hljs-number">1</span>
            <span class="hljs-function"><span class="hljs-title">ajustarMaxNumerosInput</span> = -&gt;</span>
              inputPagina.attr <span class="hljs-string">'max'</span>, paginas.count

            <span class="hljs-function"><span class="hljs-title">mostrarIndice</span> = -&gt;</span>
              indice.html(<span class="hljs-string">'Página '</span> + paginas.current + <span class="hljs-string">' de '</span> + paginas.count)

            <span class="hljs-function"><span class="hljs-title">controlarExibicaoPaginador</span> = -&gt;</span>
              containerPaginador = $ <span class="hljs-string">'.paginacao'</span>

              <span class="hljs-keyword">if</span> itens.count &gt; maximoPaginas - <span class="hljs-number">1</span>
                containerPaginador.show()
              <span class="hljs-keyword">else</span>
                containerPaginador.hide()

            ajustarMaxNumerosInput()
            mostrarIndice()
            controlarExibicaoPaginador()
          <span class="hljs-keyword">return</span>
      }

      <span class="hljs-function"><span class="hljs-title">_moverParaPagina</span> = -&gt;</span>
        pagina = parseInt(inputPagina.val())
        paginas.jPages pagina

      inputPagina.<span class="hljs-literal">on</span> <span class="hljs-string">'input'</span>, _moverParaPagina</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Efetua a validação dos campos e executa o envio de mensagens com método
GET a partir de um formulário HTML comum.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">enviarEmail</span>:<span class="hljs-function"> -&gt;</span>
    formulario = $ <span class="hljs-string">'.formulario-fale-conosco form'</span>

    <span class="hljs-keyword">if</span> formulario
      cNome       = $ <span class="hljs-string">'#nome'</span>
      cTelefone   = $ <span class="hljs-string">'#telefone'</span>
      cEmail      = $ <span class="hljs-string">'#email'</span>
      cAssunto    = $ <span class="hljs-string">'#assunto'</span>
      cMsg        = $ <span class="hljs-string">'#mensagem'</span>
      msgSucesso  = $ <span class="hljs-string">'.mensagem-sucesso'</span>
      botao       = $ <span class="hljs-string">'#enviar'</span>
      xhrComplete = <span class="hljs-number">4</span>
      xhrStatusOK = <span class="hljs-number">200</span>

      botao.<span class="hljs-literal">on</span> <span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-params">(evt)</span> -&gt;</span>
        xhr        = <span class="hljs-keyword">new</span> XMLHttpRequest()
        regexEmail = <span class="hljs-regexp">///
            ^([a-zA-Z0-9_\.\-])
            +\@(([a-zA-Z0-9\-])
            +\.)+([a-zA-Z0-9]{2,4})+$
        ///</span>
        msg        = <span class="hljs-string">''</span>

        <span class="hljs-keyword">if</span> cNome.val() <span class="hljs-keyword">isnt</span> <span class="hljs-string">''</span>
          <span class="hljs-keyword">if</span> cTelefone.val() <span class="hljs-keyword">isnt</span> <span class="hljs-string">''</span>
            <span class="hljs-keyword">if</span> cEmail.val() <span class="hljs-keyword">isnt</span> <span class="hljs-string">''</span> <span class="hljs-keyword">and</span>
               cEmail.val().match(regexEmail) <span class="hljs-keyword">isnt</span> <span class="hljs-literal">null</span>
              <span class="hljs-keyword">if</span> cMsg.val() <span class="hljs-keyword">isnt</span> <span class="hljs-string">''</span>
                msg += <span class="hljs-string">'nome='</span> + encodeURI(cNome.val())
                msg += <span class="hljs-string">'&amp;telefone='</span> + encodeURI(cTelefone.val())
                msg += <span class="hljs-string">'&amp;email='</span> + encodeURI(cEmail.val())
                msg += <span class="hljs-string">'&amp;assunto='</span> + encodeURI(cAssunto.val())
                msg += <span class="hljs-string">'&amp;mensagem='</span> + encodeURI(cMsg.val())

                xhr.open formulario.attr(<span class="hljs-string">'method'</span>), formulario.attr(<span class="hljs-string">'action'</span>) +
                                                    <span class="hljs-string">'?'</span> + msg, <span class="hljs-literal">true</span>
                xhr.send msg
                xhr.<span class="hljs-function"><span class="hljs-title">onreadystatechange</span> = -&gt;</span>
                  <span class="hljs-keyword">if</span> xhr.readyState <span class="hljs-keyword">is</span> xhrComplete <span class="hljs-keyword">and</span>
                     xhr.status <span class="hljs-keyword">is</span> xhrStatusOK
                    formulario.css <span class="hljs-string">'display'</span>, <span class="hljs-string">'none'</span>
                    msgSucesso.attr <span class="hljs-string">'class'</span>, <span class="hljs-string">'mensagem-sucesso exibir'</span>
              <span class="hljs-keyword">else</span>
                cMsg.focus()
                cMsg.attr <span class="hljs-string">'class'</span>, <span class="hljs-string">'erro'</span>
            <span class="hljs-keyword">else</span>
              cEmail.focus()
              cEmail.attr <span class="hljs-string">'class'</span>, <span class="hljs-string">'erro'</span>
          <span class="hljs-keyword">else</span>
            cTelefone.focus()
            cTelefone.attr <span class="hljs-string">'class'</span>, <span class="hljs-string">'erro'</span>
        <span class="hljs-keyword">else</span>
          cNome.focus()
          cNome.attr <span class="hljs-string">'class'</span>, <span class="hljs-string">'erro'</span>

        evt.preventDefault()
        evt.stopPropagation()
        <span class="hljs-keyword">return</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Apaga todos os campos do formulario de contato <code>Fale Conosco</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">limparFormularioContato</span>:<span class="hljs-function"> -&gt;</span>
    formulario = $ <span class="hljs-string">'.formulario-fale-conosco form'</span>

    <span class="hljs-keyword">if</span> formulario
      cNome     = $ <span class="hljs-string">'#nome'</span>
      cTelefone = $ <span class="hljs-string">'#telefone'</span>
      cEmail    = $ <span class="hljs-string">'#email'</span>
      cAssunto  = $ <span class="hljs-string">'#assunto'</span>
      cMsg      = $ <span class="hljs-string">'#mensagem'</span>
      botao     = $ <span class="hljs-string">'#apagar'</span>

      <span class="hljs-function"><span class="hljs-title">_apagar</span> = -&gt;</span>
        cNome.val <span class="hljs-string">''</span>
        cTelefone.val <span class="hljs-string">''</span>
        cEmail.val <span class="hljs-string">''</span>
        cAssunto.val <span class="hljs-string">''</span>
        cMsg.val <span class="hljs-string">''</span>
        <span class="hljs-keyword">return</span>

      botao.<span class="hljs-literal">on</span> <span class="hljs-string">'click'</span>, _apagar</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Adiciona máscara para telefone (formulário Fale Conosco)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">mascararCampoTelefone</span>:<span class="hljs-function"> -&gt;</span>
    cTelefone = $ <span class="hljs-string">'#telefone'</span>

    <span class="hljs-keyword">if</span> cTelefone
      cTelefone.mask <span class="hljs-string">'(99) ?9 9999-9999'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Remove acentuação gráfica de letras utilizando um mapa de caracteres
hexadecimais.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">removerAcentos</span>: <span class="hljs-function"><span class="hljs-params">(texto)</span> -&gt;</span>
    mapa =
        a : <span class="hljs-regexp">/[\xE0-\xE6]/g</span>
        e : <span class="hljs-regexp">/[\xE8-\xEB]/g</span>
        i : <span class="hljs-regexp">/[\xEC-\xEF]/g</span>
        o : <span class="hljs-regexp">/[\xF2-\xF6]/g</span>
        u : <span class="hljs-regexp">/[\xF9-\xFC]/g</span>
        c : <span class="hljs-regexp">/\xE7/g</span>
        n : <span class="hljs-regexp">/\xF1/g</span>

    <span class="hljs-keyword">for</span> letra <span class="hljs-keyword">of</span> mapa
      texto = texto.replace mapa[letra], letra
    texto</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Diminui um texto (<code>texto</code>) para um tamanho máximo (<code>max</code>) e acrescenta
reticências ao final.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">diminuirTexto</span>: <span class="hljs-function"><span class="hljs-params">(texto, max)</span> -&gt;</span>
    indicador = <span class="hljs-string">"…"</span>

    <span class="hljs-keyword">if</span> texto.length &gt;= max
      novoTexto = texto.substring <span class="hljs-number">0</span>, max
      <span class="hljs-keyword">if</span> novoTexto.charAt(novoTexto.length - <span class="hljs-number">1</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">' '</span>
        novoTexto = novoTexto.substring <span class="hljs-number">0</span>, max - <span class="hljs-number">1</span>
      texto = novoTexto + indicador
    <span class="hljs-keyword">else</span>
      texto = texto
    texto</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Obtem informações sobre as condições climáticas conforme a localização
geográfica do usuário.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">obterCondicoesClimaticas</span>: <span class="hljs-function"><span class="hljs-params">(cidade)</span> -&gt;</span>
    container            = $ <span class="hljs-string">'.elementos'</span>
    imagemLoading        = $ <span class="hljs-string">'.loading'</span>
    icone                = $ <span class="hljs-string">'.previsao-do-tempo .icone'</span>
    containerTemperatura = $ <span class="hljs-string">'.temperatura'</span>
    containerLocalidade  = $ <span class="hljs-string">'.localidade'</span>

    <span class="hljs-function"><span class="hljs-title">_converterBeauFort</span> = <span class="hljs-params">(velocidade)</span> -&gt;</span>
      tipoVento =
          <span class="hljs-string">'calmo'</span>             : <span class="hljs-string">'calmo'</span>
          <span class="hljs-string">'aragem'</span>            : <span class="hljs-string">'aragem'</span>
          <span class="hljs-string">'brisaLeve'</span>         : <span class="hljs-string">'brisa leve'</span>
          <span class="hljs-string">'brisaFraca'</span>        : <span class="hljs-string">'brisa fraca'</span>
          <span class="hljs-string">'brisaModerada'</span>     : <span class="hljs-string">'brisa moderada'</span>
          <span class="hljs-string">'brisaForte'</span>        : <span class="hljs-string">'brisa forte'</span>
          <span class="hljs-string">'ventoFresco'</span>       : <span class="hljs-string">'vento fresco'</span>
          <span class="hljs-string">'ventoForte'</span>        : <span class="hljs-string">'vento forte'</span>
          <span class="hljs-string">'ventania'</span>          : <span class="hljs-string">'ventania'</span>
          <span class="hljs-string">'ventaniaForte'</span>     : <span class="hljs-string">'ventania forte'</span>
          <span class="hljs-string">'tempestade'</span>        : <span class="hljs-string">'tempestade'</span>
          <span class="hljs-string">'tempestadeViolenta'</span>: <span class="hljs-string">'tempestade violenta'</span>
          <span class="hljs-string">'furacao'</span>           : <span class="hljs-string">'furacão'</span>

      <span class="hljs-keyword">if</span> velocidade &lt; <span class="hljs-number">0.3</span>
        vento = tipoVento.calmo
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">0.3</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">1.5</span>
        vento = tipoVento.aragem
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">1.6</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">3.3</span>
        vento = tipoVento.brisaLeve
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">3.4</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">5.4</span>
        vento = tipoVento.brisaFraca
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">5.5</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">7.9</span>
        vento = tipoVento.brisaModerada
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">8.0</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">10.7</span>
        vento = tipoVento.brisaForte
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">10.8</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">13.8</span>
        vento = tipoVento.ventoFresco
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">13.9</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">17.1</span>
        vento = tipoVento.ventoForte
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">17.2</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">20.7</span>
        vento = tipoVento.ventania
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">20.8</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">24.4</span>
        vento = tipoVento.ventaniaForte
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">24.5</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">28.4</span>
        vento = tipoVento.tempestade
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade <span class="hljs-keyword">is</span> <span class="hljs-number">28.5</span> <span class="hljs-keyword">or</span> velocidade &lt;= <span class="hljs-number">32.6</span>
        vento = tipoVento.tempestadeViolenta
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> velocidade &gt;= <span class="hljs-number">32.7</span>
        vento = tipoVento.furacao
      vento</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Obtém informações sobre o clima conforme a cidade</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    $.ajax {
      url     : <span class="hljs-string">'http://api.openweathermap.org/data/2.5/weather?'</span> +
                <span class="hljs-string">'q='</span> + Portal.apps.removerAcentos(cidade) + <span class="hljs-string">',brasil&amp;'</span> +
                <span class="hljs-string">'units=metric&amp;'</span> +
                <span class="hljs-string">'lang=pt'</span>
      <span class="hljs-attribute">dataType</span>: <span class="hljs-string">'json'</span>
    }
    .done <span class="hljs-function"><span class="hljs-params">(dados)</span> -&gt;</span>
      cidade         = dados.name
      cidadeCompacto = Portal.apps.diminuirTexto cidade, <span class="hljs-number">5</span>
      tempMax        = dados.main.temp_max.toFixed()
      tempMin        = dados.main.temp_min.toFixed()
      codIcone       = dados.weather[<span class="hljs-number">0</span>].icon
      clima          = dados.weather[<span class="hljs-number">0</span>].description
      vento          = dados.wind.speed
      urlIcone       = <span class="hljs-string">'http://openweathermap.org/img/w/'</span> + codIcone + <span class="hljs-string">'.png'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Corrige temperatura quando ambas (máxima e mínima) forem iguais</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> tempMin <span class="hljs-keyword">is</span> tempMax
        tempMin = tempMin - <span class="hljs-number">1</span>

      icone.css <span class="hljs-string">'background'</span>, <span class="hljs-string">'url('</span> + urlIcone + <span class="hljs-string">') no-repeat'</span>
      container.attr <span class="hljs-string">'title'</span>, <span class="hljs-string">'Descrição: '</span> + clima.toLowerCase() +
                              <span class="hljs-string">' com '</span> + _converterBeauFort(vento) +
                              <span class="hljs-string">' em '</span> + cidade + <span class="hljs-string">'.'</span> +
                              <span class="hljs-string">' Máxima: '</span> + tempMax + <span class="hljs-string">'°,'</span> +
                              <span class="hljs-string">' Mínima: '</span> + tempMin + <span class="hljs-string">'°'</span>
      containerTemperatura.html tempMax + <span class="hljs-string">'°, '</span> + tempMin + <span class="hljs-string">'° '</span>
      containerLocalidade.html cidadeCompacto

      imagemLoading.addClass <span class="hljs-string">'esconder'</span>
      container.removeClass <span class="hljs-string">'esconder'</span>

      <span class="hljs-function"><span class="hljs-title">_exibirNomeCompletoCidade</span> = <span class="hljs-params">(e)</span> -&gt;</span>
        containerLocalidade.html cidade

      <span class="hljs-function"><span class="hljs-title">_exibirNomeCompactoCidade</span> = <span class="hljs-params">(e)</span> -&gt;</span>
        containerLocalidade.html cidadeCompacto

      containerLocalidade.<span class="hljs-literal">on</span> <span class="hljs-string">'mouseenter'</span>, _exibirNomeCompletoCidade
      containerLocalidade.<span class="hljs-literal">on</span> <span class="hljs-string">'mouseleave'</span>, _exibirNomeCompactoCidade
      <span class="hljs-keyword">return</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Implementa a exibição climática no header da página com:
Temperatura máxima e mínima e vento, segundo a Escala de Beaufort.
Fonte da escala: <a href="http://pt.wikipedia.org/wiki/Escala_de_Beaufort">http://pt.wikipedia.org/wiki/Escala_de_Beaufort</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">adicionarCondicoesClimaticas</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-function"><span class="hljs-title">_adicionarCondicoesClimaticas</span> = -&gt;</span>
      <span class="hljs-function"><span class="hljs-title">_success</span> = <span class="hljs-params">(posicao)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Obtém a latitude e a longitude</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        lt = posicao.coords.latitude
        lg = posicao.coords.longitude</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Obtém o nome da cidade conforme a latitude e a longitude</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $.ajax {
          url     : <span class="hljs-string">'http://maps.googleapis.com/maps/api/geocode/json?'</span> +
                    <span class="hljs-string">'latlng='</span> + lt + <span class="hljs-string">','</span> + lg
          <span class="hljs-attribute">dataType</span>: <span class="hljs-string">'json'</span>
        }
        .done <span class="hljs-function"><span class="hljs-params">(dados)</span> -&gt;</span>
          cidade = dados.results[<span class="hljs-number">0</span>].address_components[<span class="hljs-number">3</span>].short_name
          Portal.apps.obterCondicoesClimaticas cidade
        <span class="hljs-keyword">return</span>

      <span class="hljs-function"><span class="hljs-title">_error</span> = <span class="hljs-params">(erro)</span> -&gt;</span>
        Portal.apps.obterCondicoesClimaticas <span class="hljs-string">'Maua'</span>

      _options =
        <span class="hljs-attribute">maximumAge</span>: <span class="hljs-number">75000</span>

      navigator.geolocation.getCurrentPosition _success, _error, _options

    _adicionarCondicoesClimaticas()
    <span class="hljs-keyword">return</span></pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Limita o número de caracteres do título de uma matéria no Painel do
WordPress e apresenta total e número máximo de caracteres na barra de
títulos do navegador do usuário.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">limitarCaracteresTitulos</span>: <span class="hljs-function"><span class="hljs-params">(limite)</span> -&gt;</span>
    textoTitulo = <span class="hljs-built_in">document</span>.title

    jQuery(<span class="hljs-string">'[name="post_title"]'</span>).<span class="hljs-literal">on</span> <span class="hljs-string">'keyup'</span>,<span class="hljs-function"> -&gt;</span>
      $<span class="hljs-keyword">this</span>          = jQuery <span class="hljs-keyword">this</span>
      <span class="hljs-built_in">document</span>.title = <span class="hljs-string">'('</span> + $<span class="hljs-keyword">this</span>.val().length +
                       <span class="hljs-string">' de '</span> + limite + <span class="hljs-string">' caracteres) '</span> + textoTitulo

      <span class="hljs-keyword">if</span> $<span class="hljs-keyword">this</span>.val().length &gt; limite
        $<span class="hljs-keyword">this</span>.val $<span class="hljs-keyword">this</span>.val().substr <span class="hljs-number">0</span>, limite</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Implementa atributos para que o plugin <code>LightBox2</code> possa funcionar.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">adicionarAtributoLightbox</span>:<span class="hljs-function"> -&gt;</span>
    links = $ <span class="hljs-string">'.texto div a, .texto p a'</span>

    <span class="hljs-keyword">if</span> links[<span class="hljs-number">0</span>]
      titulo = $ <span class="hljs-string">'article .titulo'</span>

      <span class="hljs-keyword">for</span> link, i <span class="hljs-keyword">in</span> links</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Verifica se a tag <code>a</code> contêm uma imagem, se sim aplica
os atributos para o LightBox</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> $(link).children().<span class="hljs-keyword">is</span> <span class="hljs-string">'IMG'</span>
          $(link).attr <span class="hljs-string">'data-lightbox'</span>, <span class="hljs-string">'roadtrip'</span>
          $(link).attr <span class="hljs-string">'data-title'</span>, titulo.text()
        <span class="hljs-keyword">else</span>
          $(link).attr <span class="hljs-string">'target'</span>, <span class="hljs-string">'_blank'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Formata data do padrão YYYY-MM-DD para DD/MM/YYYY</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">formatarData</span>:<span class="hljs-function"> -&gt;</span>
    datas = $ <span class="hljs-string">'.data-horario .data'</span>

    <span class="hljs-keyword">if</span> datas[<span class="hljs-number">0</span>]
      <span class="hljs-keyword">for</span> data, i <span class="hljs-keyword">in</span> datas
        arrData = $(data).text().split(<span class="hljs-string">':'</span>)[<span class="hljs-number">1</span>]
        arrData = arrData.split <span class="hljs-string">'-'</span>
        dia     = arrData[<span class="hljs-number">2</span>].trim()
        mes     = arrData[<span class="hljs-number">1</span>].trim()
        ano     = arrData[<span class="hljs-number">0</span>].trim()
        $(data).text <span class="hljs-string">"Data: "</span> + dia + <span class="hljs-string">"/"</span> + mes + <span class="hljs-string">"/"</span> + ano</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Cria efeito de exibição aleatória nas notícias principais da homepage</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">criarEfeitoAleatorioNoticias</span>:<span class="hljs-function"> -&gt;</span>
    containerNoticias = $ <span class="hljs-string">'.conteudo .noticias'</span>

    <span class="hljs-keyword">if</span> containerNoticias[<span class="hljs-number">0</span>]
      boxCom1  = $ <span class="hljs-string">'.box-com-1'</span>
      boxCom2  = $ <span class="hljs-string">'.box-com-2'</span>
      boxCom3  = $ <span class="hljs-string">'.box-com-3'</span>
      arranjos = [
          [boxCom1, boxCom2, boxCom3]
          [boxCom2, boxCom1, boxCom3]
          [boxCom1, boxCom3, boxCom2]
          [boxCom3, boxCom1, boxCom2]
          [boxCom3, boxCom2, boxCom1]
          [boxCom2, boxCom3, boxCom1]
      ]

      boxCom1.remove()
      boxCom2.remove()
      boxCom3.remove()

      <span class="hljs-function"><span class="hljs-title">_numeroAleatorio</span> = <span class="hljs-params">(max)</span> -&gt;</span>
        Math.floor Math.random() * max

      $(containerNoticias[<span class="hljs-number">0</span>]).append arranjos[_numeroAleatorio arranjos.length]</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Mostra ou esconde uma cópia do menu principal (exceto informações
climáticas) de acordo com a posição da barra de rolagem.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">controlarMenuScroll</span>:<span class="hljs-function"> -&gt;</span>
    $<span class="hljs-built_in">window</span> = $ <span class="hljs-built_in">window</span>

    <span class="hljs-function"><span class="hljs-title">_controlarMenu</span> = -&gt;</span>
      container  = $ <span class="hljs-string">'.topo'</span>

      <span class="hljs-keyword">if</span> container[<span class="hljs-number">0</span>]
        menu       = $ <span class="hljs-string">'.menu'</span>
        alturaMenu = <span class="hljs-number">30</span>
        maxScroll  = container.offset().top - alturaMenu

        <span class="hljs-keyword">if</span> $<span class="hljs-built_in">window</span>.scrollTop() &gt; maxScroll
          menu.removeClass(<span class="hljs-string">'esconder'</span>).addClass <span class="hljs-string">'mostrar'</span>
        <span class="hljs-keyword">else</span>
          menu.removeClass(<span class="hljs-string">'mostrar'</span>).addClass <span class="hljs-string">'esconder'</span>

    $<span class="hljs-built_in">window</span>.<span class="hljs-literal">on</span> <span class="hljs-string">'scroll'</span>, _controlarMenu</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Ativa menu da versão mobile com evento <code>ontouchstart</code> ou <code>onclick</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">touchAtivarMenu</span>:<span class="hljs-function"> -&gt;</span>
    iconeMenu = $ <span class="hljs-string">'.menu-mobile .conteudo .menu-conteudo button'</span>

    <span class="hljs-keyword">if</span> iconeMenu <span class="hljs-keyword">and</span> iconeMenu.<span class="hljs-keyword">is</span> <span class="hljs-string">':visible'</span>
      botaoMenu = $ <span class="hljs-string">'.menu-mobile .conteudo .menu-conteudo'</span>
      suporteTouch = <span class="hljs-string">'ontouchstart'</span> <span class="hljs-keyword">of</span> <span class="hljs-built_in">window</span>

      <span class="hljs-keyword">if</span> suporteTouch
        evento = <span class="hljs-string">'touchstart'</span>
      <span class="hljs-keyword">else</span>
        evento = <span class="hljs-string">'click'</span>

      <span class="hljs-function"><span class="hljs-title">_abrirMenu</span> = <span class="hljs-params">(e)</span> -&gt;</span>
        <span class="hljs-keyword">if</span> botaoMenu.hasClass <span class="hljs-string">'botao-menu-mobile-ativado'</span>
          botaoMenu.removeClass <span class="hljs-string">'botao-menu-mobile-ativado'</span>
        <span class="hljs-keyword">else</span>
          botaoMenu.addClass <span class="hljs-string">'botao-menu-mobile-ativado'</span>
        e.preventDefault()
      iconeMenu.<span class="hljs-literal">on</span> evento, _abrirMenu</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Ativa formulário de busca da versão mobile com evento <code>ontouchstart</code>
ou <code>onclick</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">touchAtivarBusca</span>:<span class="hljs-function"> -&gt;</span>
    iconeBusca = $ <span class="hljs-string">'.menu-mobile .conteudo .busca button'</span>

    <span class="hljs-keyword">if</span> iconeBusca <span class="hljs-keyword">and</span> iconeBusca.<span class="hljs-keyword">is</span> <span class="hljs-string">':visible'</span>
      botaoBusca = $ <span class="hljs-string">'.menu-mobile .conteudo .busca'</span>
      suporteTouch = <span class="hljs-string">'ontouchstart'</span> <span class="hljs-keyword">of</span> <span class="hljs-built_in">window</span>

      <span class="hljs-keyword">if</span> suporteTouch
        evento = <span class="hljs-string">'touchstart'</span>
      <span class="hljs-keyword">else</span>
        evento = <span class="hljs-string">'click'</span>

      <span class="hljs-function"><span class="hljs-title">_abrirBusca</span> = <span class="hljs-params">(e)</span> -&gt;</span>
        <span class="hljs-keyword">if</span> botaoBusca.hasClass <span class="hljs-string">'botao-busca-mobile-ativado'</span>
          botaoBusca.removeClass <span class="hljs-string">'botao-busca-mobile-ativado'</span>
        <span class="hljs-keyword">else</span>
          botaoBusca.addClass <span class="hljs-string">'botao-busca-mobile-ativado'</span>
        e.preventDefault()
      iconeBusca.<span class="hljs-literal">on</span> evento, _abrirBusca

<span class="hljs-keyword">do</span><span class="hljs-function"> -&gt;</span>
  Portal.apps.touchAtivarMenu()
  Portal.apps.touchAtivarBusca()
  Portal.apps.controlarMenuScroll()
  Portal.apps.criarEfeitoAleatorioNoticias()
  Portal.apps.paginador()
  Portal.apps.enviarEmail()
  Portal.apps.limparFormularioContato()
  Portal.apps.adicionarCondicoesClimaticas()
  Portal.apps.adicionarAtributoLightbox()
  Portal.apps.formatarData()
  Portal.apps.mascararCampoTelefone()</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
